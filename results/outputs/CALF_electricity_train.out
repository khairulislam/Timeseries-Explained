Args in experiment:
Namespace(task_name='long_term_forecast', train=True, dry_run=False, model='CALF', seed=2024, itrs=3, itr_no=None, data='custom', result_path='./results', root_path='./dataset/electricity/', data_path='electricity.csv', flag='test', features='S', target='OT', freq='h', seq_len=96, label_len=12, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=1, d_model=768, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, model_id='ori', task_loss='l1', feature_loss='l1', distill_loss='l1', logits_loss='l1', output_loss='l1', tmax=20, r=8, lora_alpha=32, lora_dropout=0.1, word_embedding_path='./utils/wte_pca_500.pt', task_w=1.0, feature_w=0.01, logits_w=1.0, output_w=1.0, gpt_layers=6, log_fine_name='CALF_result.txt', noise_scale=-100, bootstrap_eval=0, output_dict=True, use_gpu=True, enc_in=1, dec_in=1, c_out=1)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/electricity_CALF/1
>>>>>>> training : >>>>>>>>>
train 20924
val 2608
Training started at 2024-11-30 12:28:35.879469.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.4000728
	speed: 0.0491s/iter; left time: 315.7005s
	iters: 200, epoch: 1 | loss: 1.1981409
	speed: 0.0416s/iter; left time: 263.4028s
	iters: 300, epoch: 1 | loss: 0.8774902
	speed: 0.0416s/iter; left time: 259.2615s
	iters: 400, epoch: 1 | loss: 0.8006206
	speed: 0.0417s/iter; left time: 255.4791s
	iters: 500, epoch: 1 | loss: 0.7115666
	speed: 0.0416s/iter; left time: 250.8621s
	iters: 600, epoch: 1 | loss: 0.6438857
	speed: 0.0415s/iter; left time: 246.3317s
Epoch: 1 cost time: 27.946121215820312
Epoch: 1, Steps: 653 | Train Loss: 1.0095 Vali Loss: 0.36175
Validation loss decreased (inf --> 0.361752).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6276979
	speed: 0.1591s/iter; left time: 919.2996s
	iters: 200, epoch: 2 | loss: 0.6270020
	speed: 0.0418s/iter; left time: 237.2356s
	iters: 300, epoch: 2 | loss: 0.5989106
	speed: 0.0418s/iter; left time: 233.0476s
	iters: 400, epoch: 2 | loss: 0.6761388
	speed: 0.0421s/iter; left time: 230.6223s
	iters: 500, epoch: 2 | loss: 0.5524272
	speed: 0.0418s/iter; left time: 224.9867s
	iters: 600, epoch: 2 | loss: 0.5503187
	speed: 0.0417s/iter; left time: 219.9291s
Epoch: 2 cost time: 27.323054313659668
Epoch: 2, Steps: 653 | Train Loss: 0.5979 Vali Loss: 0.28704
Validation loss decreased (0.361752 --> 0.287041).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4639791
	speed: 0.1500s/iter; left time: 768.9152s
	iters: 200, epoch: 3 | loss: 0.5221764
	speed: 0.0419s/iter; left time: 210.5047s
	iters: 300, epoch: 3 | loss: 0.5515755
	speed: 0.0418s/iter; left time: 205.9256s
	iters: 400, epoch: 3 | loss: 0.5222920
	speed: 0.0419s/iter; left time: 202.2383s
	iters: 500, epoch: 3 | loss: 0.5073834
	speed: 0.0419s/iter; left time: 197.8692s
	iters: 600, epoch: 3 | loss: 0.5577874
	speed: 0.0419s/iter; left time: 193.9310s
Epoch: 3 cost time: 27.356467723846436
Epoch: 3, Steps: 653 | Train Loss: 0.51921 Vali Loss: 0.27657
Validation loss decreased (0.287041 --> 0.276566).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4628837
	speed: 0.1510s/iter; left time: 675.3726s
	iters: 200, epoch: 4 | loss: 0.4496680
	speed: 0.0418s/iter; left time: 182.9291s
	iters: 300, epoch: 4 | loss: 0.4798715
	speed: 0.0419s/iter; left time: 179.1703s
	iters: 400, epoch: 4 | loss: 0.4514627
	speed: 0.0420s/iter; left time: 175.1237s
	iters: 500, epoch: 4 | loss: 0.4783126
	speed: 0.0419s/iter; left time: 170.7675s
	iters: 600, epoch: 4 | loss: 0.4592613
	speed: 0.0420s/iter; left time: 166.7715s
Epoch: 4 cost time: 27.428677082061768
Epoch: 4, Steps: 653 | Train Loss: 0.48308 Vali Loss: 0.25753
Validation loss decreased (0.276566 --> 0.257534).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4497694
	speed: 0.1512s/iter; left time: 577.5710s
	iters: 200, epoch: 5 | loss: 0.5015835
	speed: 0.0419s/iter; left time: 155.9197s
	iters: 300, epoch: 5 | loss: 0.4634241
	speed: 0.0419s/iter; left time: 151.4878s
	iters: 400, epoch: 5 | loss: 0.4719375
	speed: 0.0418s/iter; left time: 147.0052s
	iters: 500, epoch: 5 | loss: 0.4623255
	speed: 0.0424s/iter; left time: 144.8346s
	iters: 600, epoch: 5 | loss: 0.4674201
	speed: 0.0419s/iter; left time: 139.0046s
Epoch: 5 cost time: 27.416345596313477
Epoch: 5, Steps: 653 | Train Loss: 0.46375 Vali Loss: 0.27405
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/1/checkpoint.pth
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4650335
	speed: 0.0823s/iter; left time: 260.6454s
	iters: 200, epoch: 6 | loss: 0.4457324
	speed: 0.0422s/iter; left time: 129.2518s
	iters: 300, epoch: 6 | loss: 0.4589437
	speed: 0.0419s/iter; left time: 124.3067s
	iters: 400, epoch: 6 | loss: 0.4736544
	speed: 0.0421s/iter; left time: 120.6927s
	iters: 500, epoch: 6 | loss: 0.4790850
	speed: 0.0421s/iter; left time: 116.5092s
	iters: 600, epoch: 6 | loss: 0.4960552
	speed: 0.0420s/iter; left time: 112.0368s
Epoch: 6 cost time: 27.4679536819458
Epoch: 6, Steps: 653 | Train Loss: 0.46011 Vali Loss: 0.26707
EarlyStopping counter: 2 out of 3
Loading model from ./results/electricity_CALF/1/checkpoint.pth
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4949493
	speed: 0.0826s/iter; left time: 207.4689s
	iters: 200, epoch: 7 | loss: 0.4725488
	speed: 0.0421s/iter; left time: 101.5718s
	iters: 300, epoch: 7 | loss: 0.4078021
	speed: 0.0419s/iter; left time: 96.9726s
	iters: 400, epoch: 7 | loss: 0.4897127
	speed: 0.0421s/iter; left time: 93.1868s
	iters: 500, epoch: 7 | loss: 0.4482698
	speed: 0.0422s/iter; left time: 89.1079s
	iters: 600, epoch: 7 | loss: 0.5037972
	speed: 0.0419s/iter; left time: 84.4320s
Epoch: 7 cost time: 27.462875604629517
Epoch: 7, Steps: 653 | Train Loss: 0.46048 Vali Loss: 0.26177
EarlyStopping counter: 3 out of 3
Early stopping
Training ended at 2024-11-30 12:32:28.721616, time taken 0:03:52.842147, per epoch 0:00:29.105268
Loading model from ./results/electricity_CALF/1/checkpoint.pth
val 2608
Preds and Trues shape: (2608, 24, 1) (2608, 24, 1)
flag:val, mse:0.25616, mae:0.35538, rmse: 0.50612.
>>>>>>> testing : <<<<<<<<<<<
test 2607
Preds and Trues shape: (2607, 24, 1) (2607, 24, 1)
flag:test, mse:0.15555, mae:0.28472, rmse: 0.3944.


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/electricity_CALF/2
>>>>>>> training : >>>>>>>>>
train 20924
val 2608
Training started at 2024-11-30 12:32:36.872399.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.0135262
	speed: 0.0421s/iter; left time: 270.5208s
	iters: 200, epoch: 1 | loss: 0.8874246
	speed: 0.0420s/iter; left time: 265.8161s
	iters: 300, epoch: 1 | loss: 0.6329653
	speed: 0.0420s/iter; left time: 261.5896s
	iters: 400, epoch: 1 | loss: 0.5939405
	speed: 0.0420s/iter; left time: 257.5229s
	iters: 500, epoch: 1 | loss: 0.6350014
	speed: 0.0421s/iter; left time: 253.7067s
	iters: 600, epoch: 1 | loss: 0.5666995
	speed: 0.0421s/iter; left time: 249.5941s
Epoch: 1 cost time: 27.464113235473633
Epoch: 1, Steps: 653 | Train Loss: 0.8105 Vali Loss: 0.37439
Validation loss decreased (inf --> 0.374388).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5837078
	speed: 0.1562s/iter; left time: 902.3779s
	iters: 200, epoch: 2 | loss: 0.5267924
	speed: 0.0428s/iter; left time: 242.7676s
	iters: 300, epoch: 2 | loss: 0.5875257
	speed: 0.0431s/iter; left time: 240.5587s
	iters: 400, epoch: 2 | loss: 0.5201256
	speed: 0.0419s/iter; left time: 229.6934s
	iters: 500, epoch: 2 | loss: 0.4919979
	speed: 0.0420s/iter; left time: 225.9245s
	iters: 600, epoch: 2 | loss: 0.5045492
	speed: 0.0419s/iter; left time: 221.1168s
Epoch: 2 cost time: 27.652737379074097
Epoch: 2, Steps: 653 | Train Loss: 0.52034 Vali Loss: 0.29052
Validation loss decreased (0.374388 --> 0.290523).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4372067
	speed: 0.1599s/iter; left time: 819.4557s
	iters: 200, epoch: 3 | loss: 0.4236092
	speed: 0.0419s/iter; left time: 210.6945s
	iters: 300, epoch: 3 | loss: 0.4633359
	speed: 0.0419s/iter; left time: 206.2299s
	iters: 400, epoch: 3 | loss: 0.4523455
	speed: 0.0419s/iter; left time: 202.1641s
	iters: 500, epoch: 3 | loss: 0.4854678
	speed: 0.0421s/iter; left time: 198.8956s
	iters: 600, epoch: 3 | loss: 0.4570948
	speed: 0.0420s/iter; left time: 194.0945s
Epoch: 3 cost time: 27.436708211898804
Epoch: 3, Steps: 653 | Train Loss: 0.46748 Vali Loss: 0.29897
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/2/checkpoint.pth
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4253852
	speed: 0.0828s/iter; left time: 370.1943s
	iters: 200, epoch: 4 | loss: 0.4778714
	speed: 0.0418s/iter; left time: 182.6869s
	iters: 300, epoch: 4 | loss: 0.4539421
	speed: 0.0420s/iter; left time: 179.5070s
	iters: 400, epoch: 4 | loss: 0.4397355
	speed: 0.0418s/iter; left time: 174.3054s
	iters: 500, epoch: 4 | loss: 0.4765881
	speed: 0.0422s/iter; left time: 171.6577s
	iters: 600, epoch: 4 | loss: 0.4335231
	speed: 0.0422s/iter; left time: 167.8026s
Epoch: 4 cost time: 27.454387187957764
Epoch: 4, Steps: 653 | Train Loss: 0.45933 Vali Loss: 0.26983
Validation loss decreased (0.290523 --> 0.269831).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4198027
	speed: 0.1553s/iter; left time: 593.1136s
	iters: 200, epoch: 5 | loss: 0.4951906
	speed: 0.0420s/iter; left time: 156.2019s
	iters: 300, epoch: 5 | loss: 0.3912935
	speed: 0.0425s/iter; left time: 153.6696s
	iters: 400, epoch: 5 | loss: 0.3553911
	speed: 0.0420s/iter; left time: 147.6991s
	iters: 500, epoch: 5 | loss: 0.3884464
	speed: 0.0420s/iter; left time: 143.4896s
	iters: 600, epoch: 5 | loss: 0.4506401
	speed: 0.0421s/iter; left time: 139.5994s
Epoch: 5 cost time: 27.492940425872803
Epoch: 5, Steps: 653 | Train Loss: 0.44152 Vali Loss: 0.26927
Validation loss decreased (0.269831 --> 0.269268).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4684951
	speed: 0.1583s/iter; left time: 501.2079s
	iters: 200, epoch: 6 | loss: 0.3729923
	speed: 0.0418s/iter; left time: 128.3109s
	iters: 300, epoch: 6 | loss: 0.4561110
	speed: 0.0420s/iter; left time: 124.6737s
	iters: 400, epoch: 6 | loss: 0.4410144
	speed: 0.0421s/iter; left time: 120.6956s
	iters: 500, epoch: 6 | loss: 0.4836461
	speed: 0.0420s/iter; left time: 116.2630s
	iters: 600, epoch: 6 | loss: 0.4106461
	speed: 0.0421s/iter; left time: 112.1295s
Epoch: 6 cost time: 27.478503465652466
Epoch: 6, Steps: 653 | Train Loss: 0.43079 Vali Loss: 0.27095
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/2/checkpoint.pth
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4657879
	speed: 0.0818s/iter; left time: 205.6189s
	iters: 200, epoch: 7 | loss: 0.4536955
	speed: 0.0418s/iter; left time: 100.8304s
	iters: 300, epoch: 7 | loss: 0.4725983
	speed: 0.0420s/iter; left time: 97.1205s
	iters: 400, epoch: 7 | loss: 0.4011621
	speed: 0.0420s/iter; left time: 92.8371s
	iters: 500, epoch: 7 | loss: 0.4294688
	speed: 0.0423s/iter; left time: 89.2850s
	iters: 600, epoch: 7 | loss: 0.4023739
	speed: 0.0422s/iter; left time: 84.8854s
Epoch: 7 cost time: 27.427361965179443
Epoch: 7, Steps: 653 | Train Loss: 0.42965 Vali Loss: 0.25899
Validation loss decreased (0.269268 --> 0.258992).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4328192
	speed: 0.1561s/iter; left time: 290.2613s
	iters: 200, epoch: 8 | loss: 0.3991309
	speed: 0.0419s/iter; left time: 73.7838s
	iters: 300, epoch: 8 | loss: 0.5019967
	speed: 0.0419s/iter; left time: 69.6040s
	iters: 400, epoch: 8 | loss: 0.4268934
	speed: 0.0421s/iter; left time: 65.6475s
	iters: 500, epoch: 8 | loss: 0.5137456
	speed: 0.0418s/iter; left time: 61.0202s
	iters: 600, epoch: 8 | loss: 0.3844677
	speed: 0.0419s/iter; left time: 57.0375s
Epoch: 8 cost time: 27.4230899810791
Epoch: 8, Steps: 653 | Train Loss: 0.42583 Vali Loss: 0.25927
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/2/checkpoint.pth
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4278763
	speed: 0.0821s/iter; left time: 99.0948s
	iters: 200, epoch: 9 | loss: 0.4018817
	speed: 0.0420s/iter; left time: 46.4421s
	iters: 300, epoch: 9 | loss: 0.3997120
	speed: 0.0417s/iter; left time: 41.9556s
	iters: 400, epoch: 9 | loss: 0.4434333
	speed: 0.0422s/iter; left time: 38.3012s
	iters: 500, epoch: 9 | loss: 0.4635786
	speed: 0.0420s/iter; left time: 33.8732s
	iters: 600, epoch: 9 | loss: 0.4657509
	speed: 0.0420s/iter; left time: 29.6741s
Epoch: 9 cost time: 27.40798544883728
Epoch: 9, Steps: 653 | Train Loss: 0.42613 Vali Loss: 0.26083
EarlyStopping counter: 2 out of 3
Loading model from ./results/electricity_CALF/2/checkpoint.pth
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3695921
	speed: 0.0823s/iter; left time: 45.5941s
	iters: 200, epoch: 10 | loss: 0.4395691
	speed: 0.0421s/iter; left time: 19.1255s
	iters: 300, epoch: 10 | loss: 0.4538919
	speed: 0.0421s/iter; left time: 14.8948s
	iters: 400, epoch: 10 | loss: 0.3889950
	speed: 0.0422s/iter; left time: 10.7186s
	iters: 500, epoch: 10 | loss: 0.4502635
	speed: 0.0421s/iter; left time: 6.4827s
	iters: 600, epoch: 10 | loss: 0.3966581
	speed: 0.0419s/iter; left time: 2.2647s
Epoch: 10 cost time: 27.477567195892334
Epoch: 10, Steps: 653 | Train Loss: 0.42648 Vali Loss: 0.26049
EarlyStopping counter: 3 out of 3
Early stopping
Training ended at 2024-11-30 12:38:06.429914, time taken 0:05:29.557515, per epoch 0:00:29.959774
Loading model from ./results/electricity_CALF/2/checkpoint.pth
val 2608
Preds and Trues shape: (2608, 24, 1) (2608, 24, 1)
flag:val, mse:0.2591, mae:0.35818, rmse: 0.50902.
>>>>>>> testing : <<<<<<<<<<<
test 2607
Preds and Trues shape: (2607, 24, 1) (2607, 24, 1)
flag:test, mse:0.14971, mae:0.28059, rmse: 0.38693.


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/electricity_CALF/3
>>>>>>> training : >>>>>>>>>
train 20924
val 2608
Training started at 2024-11-30 12:38:14.296678.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.4153659
	speed: 0.0420s/iter; left time: 270.0013s
	iters: 200, epoch: 1 | loss: 1.2205489
	speed: 0.0421s/iter; left time: 266.7381s
	iters: 300, epoch: 1 | loss: 0.9207063
	speed: 0.0420s/iter; left time: 261.8723s
	iters: 400, epoch: 1 | loss: 0.7782380
	speed: 0.0421s/iter; left time: 257.9294s
	iters: 500, epoch: 1 | loss: 0.7047133
	speed: 0.0423s/iter; left time: 255.2701s
	iters: 600, epoch: 1 | loss: 0.7753724
	speed: 0.0419s/iter; left time: 248.6234s
Epoch: 1 cost time: 27.485548734664917
Epoch: 1, Steps: 653 | Train Loss: 1.0403 Vali Loss: 0.29165
Validation loss decreased (inf --> 0.291652).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6347834
	speed: 0.1534s/iter; left time: 886.3480s
	iters: 200, epoch: 2 | loss: 0.6978354
	speed: 0.0417s/iter; left time: 236.8780s
	iters: 300, epoch: 2 | loss: 0.6003188
	speed: 0.0419s/iter; left time: 233.7721s
	iters: 400, epoch: 2 | loss: 0.6001313
	speed: 0.0419s/iter; left time: 229.5512s
	iters: 500, epoch: 2 | loss: 0.5957861
	speed: 0.0422s/iter; left time: 226.9925s
	iters: 600, epoch: 2 | loss: 0.6364912
	speed: 0.0423s/iter; left time: 223.5132s
Epoch: 2 cost time: 27.43657112121582
Epoch: 2, Steps: 653 | Train Loss: 0.64166 Vali Loss: 0.27417
Validation loss decreased (0.291652 --> 0.274171).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5417827
	speed: 0.1545s/iter; left time: 791.9430s
	iters: 200, epoch: 3 | loss: 0.5805898
	speed: 0.0419s/iter; left time: 210.7599s
	iters: 300, epoch: 3 | loss: 0.5637481
	speed: 0.0420s/iter; left time: 206.8347s
	iters: 400, epoch: 3 | loss: 0.5408189
	speed: 0.0423s/iter; left time: 204.0837s
	iters: 500, epoch: 3 | loss: 0.5751171
	speed: 0.0421s/iter; left time: 198.8955s
	iters: 600, epoch: 3 | loss: 0.5076901
	speed: 0.0422s/iter; left time: 195.0812s
Epoch: 3 cost time: 27.501177549362183
Epoch: 3, Steps: 653 | Train Loss: 0.54964 Vali Loss: 0.34297
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/3/checkpoint.pth
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5374188
	speed: 0.0817s/iter; left time: 365.3344s
	iters: 200, epoch: 4 | loss: 0.5084990
	speed: 0.0420s/iter; left time: 183.5326s
	iters: 300, epoch: 4 | loss: 0.5883226
	speed: 0.0424s/iter; left time: 181.1919s
	iters: 400, epoch: 4 | loss: 0.6180019
	speed: 0.0424s/iter; left time: 176.9771s
	iters: 500, epoch: 4 | loss: 0.5478314
	speed: 0.0419s/iter; left time: 170.7316s
	iters: 600, epoch: 4 | loss: 0.5838208
	speed: 0.0420s/iter; left time: 166.7952s
Epoch: 4 cost time: 27.533985376358032
Epoch: 4, Steps: 653 | Train Loss: 0.53904 Vali Loss: 0.269
Validation loss decreased (0.274171 --> 0.268997).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4979716
	speed: 0.1544s/iter; left time: 589.6754s
	iters: 200, epoch: 5 | loss: 0.5188270
	speed: 0.0419s/iter; left time: 155.9932s
	iters: 300, epoch: 5 | loss: 0.5024799
	speed: 0.0424s/iter; left time: 153.3898s
	iters: 400, epoch: 5 | loss: 0.4947921
	speed: 0.0419s/iter; left time: 147.4839s
	iters: 500, epoch: 5 | loss: 0.4934863
	speed: 0.0420s/iter; left time: 143.4430s
	iters: 600, epoch: 5 | loss: 0.5027542
	speed: 0.0420s/iter; left time: 139.3750s
Epoch: 5 cost time: 27.469894647598267
Epoch: 5, Steps: 653 | Train Loss: 0.51356 Vali Loss: 0.28827
EarlyStopping counter: 1 out of 3
Loading model from ./results/electricity_CALF/3/checkpoint.pth
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.5284181
	speed: 0.0819s/iter; left time: 259.1568s
	iters: 200, epoch: 6 | loss: 0.5630060
	speed: 0.0422s/iter; left time: 129.3910s
	iters: 300, epoch: 6 | loss: 0.4785352
	speed: 0.0419s/iter; left time: 124.3195s
	iters: 400, epoch: 6 | loss: 0.4978722
	speed: 0.0420s/iter; left time: 120.4755s
	iters: 500, epoch: 6 | loss: 0.5129250
	speed: 0.0423s/iter; left time: 117.0211s
	iters: 600, epoch: 6 | loss: 0.4887014
	speed: 0.0420s/iter; left time: 111.8391s
Epoch: 6 cost time: 27.455992698669434
Epoch: 6, Steps: 653 | Train Loss: 0.51098 Vali Loss: 0.27086
EarlyStopping counter: 2 out of 3
Loading model from ./results/electricity_CALF/3/checkpoint.pth
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5364211
	speed: 0.0819s/iter; left time: 205.8503s
	iters: 200, epoch: 7 | loss: 0.5144343
	speed: 0.0420s/iter; left time: 101.2971s
	iters: 300, epoch: 7 | loss: 0.4643052
	speed: 0.0423s/iter; left time: 97.7759s
	iters: 400, epoch: 7 | loss: 0.5626265
	speed: 0.0421s/iter; left time: 93.1644s
	iters: 500, epoch: 7 | loss: 0.4998379
	speed: 0.0421s/iter; left time: 89.0567s
	iters: 600, epoch: 7 | loss: 0.5554301
	speed: 0.0423s/iter; left time: 85.2026s
Epoch: 7 cost time: 27.485150814056396
Epoch: 7, Steps: 653 | Train Loss: 0.51106 Vali Loss: 0.26612
Validation loss decreased (0.268997 --> 0.266125).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.5269489
	speed: 0.1502s/iter; left time: 279.3488s
	iters: 200, epoch: 8 | loss: 0.5485488
	speed: 0.0421s/iter; left time: 74.0112s
	iters: 300, epoch: 8 | loss: 0.4828443
	speed: 0.0420s/iter; left time: 69.6420s
	iters: 400, epoch: 8 | loss: 0.4584202
	speed: 0.0421s/iter; left time: 65.7331s
	iters: 500, epoch: 8 | loss: 0.5267132
	speed: 0.0422s/iter; left time: 61.5702s
	iters: 600, epoch: 8 | loss: 0.4812346
	speed: 0.0421s/iter; left time: 57.2627s
Epoch: 8 cost time: 27.512648105621338
Epoch: 8, Steps: 653 | Train Loss: 0.50477 Vali Loss: 0.26411
Validation loss decreased (0.266125 --> 0.264112).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.5114849
	speed: 0.1507s/iter; left time: 181.8823s
	iters: 200, epoch: 9 | loss: 0.4589070
	speed: 0.0421s/iter; left time: 46.5980s
	iters: 300, epoch: 9 | loss: 0.4948463
	speed: 0.0421s/iter; left time: 42.4295s
	iters: 400, epoch: 9 | loss: 0.4919028
	speed: 0.0422s/iter; left time: 38.2497s
	iters: 500, epoch: 9 | loss: 0.5055622
	speed: 0.0419s/iter; left time: 33.8167s
	iters: 600, epoch: 9 | loss: 0.5257012
	speed: 0.0420s/iter; left time: 29.7045s
Epoch: 9 cost time: 27.48652172088623
Epoch: 9, Steps: 653 | Train Loss: 0.50263 Vali Loss: 0.26233
Validation loss decreased (0.264112 --> 0.262326).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4760926
	speed: 0.1511s/iter; left time: 83.6892s
	iters: 200, epoch: 10 | loss: 0.5067310
	speed: 0.0420s/iter; left time: 19.0726s
	iters: 300, epoch: 10 | loss: 0.4935887
	speed: 0.0420s/iter; left time: 14.8793s
	iters: 400, epoch: 10 | loss: 0.5066491
	speed: 0.0422s/iter; left time: 10.7062s
	iters: 500, epoch: 10 | loss: 0.4855335
	speed: 0.0424s/iter; left time: 6.5295s
	iters: 600, epoch: 10 | loss: 0.5214068
	speed: 0.0420s/iter; left time: 2.2654s
Epoch: 10 cost time: 27.55603790283203
Epoch: 10, Steps: 653 | Train Loss: 0.50111 Vali Loss: 0.26038
Validation loss decreased (0.262326 --> 0.260381).  Saving model ...
Updating learning rate to 1.953125e-06
Training ended at 2024-11-30 12:43:55.872963, time taken 0:05:41.576285, per epoch 0:00:34.157628
Loading model from ./results/electricity_CALF/3/checkpoint.pth
val 2608
Preds and Trues shape: (2608, 24, 1) (2608, 24, 1)
flag:val, mse:0.25966, mae:0.35594, rmse: 0.50957.
>>>>>>> testing : <<<<<<<<<<<
test 2607
Preds and Trues shape: (2607, 24, 1) (2607, 24, 1)
flag:test, mse:0.14736, mae:0.27731, rmse: 0.38388.

