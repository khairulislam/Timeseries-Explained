Args in experiment:
Namespace(task_name='long_term_forecast', train=True, dry_run=False, model='CALF', seed=2024, itrs=3, itr_no=None, data='custom', result_path='./results', root_path='./dataset/traffic/', data_path='traffic.csv', flag='test', features='S', target='OT', freq='h', seq_len=96, label_len=12, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=1, d_model=768, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, augmentation_ratio=0, model_id='ori', task_loss='l1', feature_loss='l1', distill_loss='l1', logits_loss='l1', output_loss='l1', tmax=20, r=8, lora_alpha=32, lora_dropout=0.1, word_embedding_path='./utils/wte_pca_500.pt', task_w=1.0, feature_w=0.01, logits_w=1.0, output_w=1.0, gpt_layers=6, log_fine_name='CALF_result.txt', noise_scale=-100, bootstrap_eval=0, output_dict=True, use_gpu=True, enc_in=1, dec_in=1, c_out=1)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/traffic_CALF/1
>>>>>>> training : >>>>>>>>>
train 13916
val 1732
Training started at 2024-12-01 23:36:41.034971.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.2183567
	speed: 0.1282s/iter; left time: 543.5744s
	iters: 200, epoch: 1 | loss: 0.7132733
	speed: 0.0502s/iter; left time: 207.9905s
	iters: 300, epoch: 1 | loss: 0.6171120
	speed: 0.0502s/iter; left time: 202.9364s
	iters: 400, epoch: 1 | loss: 0.5556887
	speed: 0.0505s/iter; left time: 199.0225s
Epoch: 1 cost time: 29.63276982307434
Epoch: 1, Steps: 434 | Train Loss: 0.94305 Vali Loss: 0.19682
Validation loss decreased (inf --> 0.196824).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4810050
	speed: 0.1644s/iter; left time: 625.8218s
	iters: 200, epoch: 2 | loss: 0.4978499
	speed: 0.0502s/iter; left time: 186.1761s
	iters: 300, epoch: 2 | loss: 0.4137144
	speed: 0.0502s/iter; left time: 181.1995s
	iters: 400, epoch: 2 | loss: 0.4001564
	speed: 0.0505s/iter; left time: 177.0783s
Epoch: 2 cost time: 21.855014085769653
Epoch: 2, Steps: 434 | Train Loss: 0.4627 Vali Loss: 0.12602
Validation loss decreased (0.196824 --> 0.126017).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3769431
	speed: 0.1531s/iter; left time: 516.5634s
	iters: 200, epoch: 3 | loss: 0.3719150
	speed: 0.0503s/iter; left time: 164.7409s
	iters: 300, epoch: 3 | loss: 0.3649135
	speed: 0.0505s/iter; left time: 160.1656s
	iters: 400, epoch: 3 | loss: 0.3584395
	speed: 0.0505s/iter; left time: 155.0831s
Epoch: 3 cost time: 21.907522439956665
Epoch: 3, Steps: 434 | Train Loss: 0.3779 Vali Loss: 0.11265
Validation loss decreased (0.126017 --> 0.112649).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3208566
	speed: 0.1588s/iter; left time: 466.8496s
	iters: 200, epoch: 4 | loss: 0.3599552
	speed: 0.0504s/iter; left time: 143.1019s
	iters: 300, epoch: 4 | loss: 0.3548690
	speed: 0.0505s/iter; left time: 138.2543s
	iters: 400, epoch: 4 | loss: 0.3344974
	speed: 0.0502s/iter; left time: 132.4492s
Epoch: 4 cost time: 21.89427161216736
Epoch: 4, Steps: 434 | Train Loss: 0.34679 Vali Loss: 0.098327
Validation loss decreased (0.112649 --> 0.098327).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3428821
	speed: 0.1542s/iter; left time: 386.3782s
	iters: 200, epoch: 5 | loss: 0.3182387
	speed: 0.0504s/iter; left time: 121.1160s
	iters: 300, epoch: 5 | loss: 0.3205700
	speed: 0.0507s/iter; left time: 116.8411s
	iters: 400, epoch: 5 | loss: 0.3140884
	speed: 0.0506s/iter; left time: 111.6014s
Epoch: 5 cost time: 21.973195552825928
Epoch: 5, Steps: 434 | Train Loss: 0.33046 Vali Loss: 0.090875
Validation loss decreased (0.098327 --> 0.090875).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2949538
	speed: 0.1541s/iter; left time: 319.1084s
	iters: 200, epoch: 6 | loss: 0.2957373
	speed: 0.0507s/iter; left time: 99.8899s
	iters: 300, epoch: 6 | loss: 0.3312100
	speed: 0.0505s/iter; left time: 94.4173s
	iters: 400, epoch: 6 | loss: 0.3374284
	speed: 0.0505s/iter; left time: 89.4487s
Epoch: 6 cost time: 22.0147123336792
Epoch: 6, Steps: 434 | Train Loss: 0.3209 Vali Loss: 0.08819
Validation loss decreased (0.090875 --> 0.088190).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3544688
	speed: 0.1586s/iter; left time: 259.7080s
	iters: 200, epoch: 7 | loss: 0.3071209
	speed: 0.0505s/iter; left time: 77.6329s
	iters: 300, epoch: 7 | loss: 0.3359465
	speed: 0.0505s/iter; left time: 72.5648s
	iters: 400, epoch: 7 | loss: 0.3224435
	speed: 0.0503s/iter; left time: 67.2669s
Epoch: 7 cost time: 21.895002126693726
Epoch: 7, Steps: 434 | Train Loss: 0.31614 Vali Loss: 0.086525
Validation loss decreased (0.088190 --> 0.086525).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3006246
	speed: 0.1536s/iter; left time: 184.7466s
	iters: 200, epoch: 8 | loss: 0.3205129
	speed: 0.0506s/iter; left time: 55.8414s
	iters: 300, epoch: 8 | loss: 0.2944716
	speed: 0.0506s/iter; left time: 50.7605s
	iters: 400, epoch: 8 | loss: 0.3184433
	speed: 0.0509s/iter; left time: 45.9298s
Epoch: 8 cost time: 21.9856538772583
Epoch: 8, Steps: 434 | Train Loss: 0.31299 Vali Loss: 0.086548
EarlyStopping counter: 1 out of 3
Loading model from ./results/traffic_CALF/1/checkpoint.pth
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3032736
	speed: 0.0847s/iter; left time: 65.0964s
	iters: 200, epoch: 9 | loss: 0.2905260
	speed: 0.0503s/iter; left time: 33.6602s
	iters: 300, epoch: 9 | loss: 0.3251969
	speed: 0.0505s/iter; left time: 28.7484s
	iters: 400, epoch: 9 | loss: 0.3092671
	speed: 0.0506s/iter; left time: 23.7457s
Epoch: 9 cost time: 21.938454151153564
Epoch: 9, Steps: 434 | Train Loss: 0.31294 Vali Loss: 0.086125
Validation loss decreased (0.086525 --> 0.086125).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3111169
	speed: 0.1503s/iter; left time: 50.3657s
	iters: 200, epoch: 10 | loss: 0.3217398
	speed: 0.0506s/iter; left time: 11.8938s
	iters: 300, epoch: 10 | loss: 0.2937842
	speed: 0.0505s/iter; left time: 6.8166s
	iters: 400, epoch: 10 | loss: 0.3482437
	speed: 0.0503s/iter; left time: 1.7612s
Epoch: 10 cost time: 21.933654308319092
Epoch: 10, Steps: 434 | Train Loss: 0.3123 Vali Loss: 0.08614
EarlyStopping counter: 1 out of 3
Loading model from ./results/traffic_CALF/1/checkpoint.pth
Updating learning rate to 1.953125e-06
Training ended at 2024-12-01 23:41:41.816317, time taken 0:05:00.781346, per epoch 0:00:30.078135
Loading model from ./results/traffic_CALF/1/checkpoint.pth
val 1732
Preds and Trues shape: (1732, 24, 1) (1732, 24, 1)
flag:val, mse:0.08587, mae:0.20584, rmse: 0.29304.
>>>>>>> testing : <<<<<<<<<<<
test 1731
Preds and Trues shape: (1731, 24, 1) (1731, 24, 1)
flag:test, mse:0.2322, mae:0.3053, rmse: 0.48187.


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/traffic_CALF/2
>>>>>>> training : >>>>>>>>>
train 13916
val 1732
Training started at 2024-12-01 23:41:52.983584.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.4110420
	speed: 0.0507s/iter; left time: 215.0438s
	iters: 200, epoch: 1 | loss: 0.8758690
	speed: 0.0507s/iter; left time: 209.9963s
	iters: 300, epoch: 1 | loss: 0.6288292
	speed: 0.0507s/iter; left time: 204.7020s
	iters: 400, epoch: 1 | loss: 0.5574039
	speed: 0.0507s/iter; left time: 199.7694s
Epoch: 1 cost time: 22.029202938079834
Epoch: 1, Steps: 434 | Train Loss: 0.99957 Vali Loss: 0.18291
Validation loss decreased (inf --> 0.182909).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4609290
	speed: 0.1544s/iter; left time: 587.9277s
	iters: 200, epoch: 2 | loss: 0.4845149
	speed: 0.0506s/iter; left time: 187.3921s
	iters: 300, epoch: 2 | loss: 0.4292864
	speed: 0.0507s/iter; left time: 182.9771s
	iters: 400, epoch: 2 | loss: 0.3913378
	speed: 0.0508s/iter; left time: 178.1339s
Epoch: 2 cost time: 22.022515535354614
Epoch: 2, Steps: 434 | Train Loss: 0.45574 Vali Loss: 0.13361
Validation loss decreased (0.182909 --> 0.133608).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3734654
	speed: 0.1548s/iter; left time: 522.3011s
	iters: 200, epoch: 3 | loss: 0.3717940
	speed: 0.0504s/iter; left time: 164.8892s
	iters: 300, epoch: 3 | loss: 0.3807828
	speed: 0.0508s/iter; left time: 161.0345s
	iters: 400, epoch: 3 | loss: 0.3441480
	speed: 0.0506s/iter; left time: 155.6331s
Epoch: 3 cost time: 21.960971117019653
Epoch: 3, Steps: 434 | Train Loss: 0.37262 Vali Loss: 0.11017
Validation loss decreased (0.133608 --> 0.110175).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3298815
	speed: 0.1539s/iter; left time: 452.4457s
	iters: 200, epoch: 4 | loss: 0.3637653
	speed: 0.0504s/iter; left time: 143.0347s
	iters: 300, epoch: 4 | loss: 0.3648158
	speed: 0.0507s/iter; left time: 138.9652s
	iters: 400, epoch: 4 | loss: 0.3507162
	speed: 0.0507s/iter; left time: 133.8459s
Epoch: 4 cost time: 21.969546794891357
Epoch: 4, Steps: 434 | Train Loss: 0.34215 Vali Loss: 0.10071
Validation loss decreased (0.110175 --> 0.100709).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3042979
	speed: 0.1552s/iter; left time: 388.7732s
	iters: 200, epoch: 5 | loss: 0.3705007
	speed: 0.0507s/iter; left time: 121.8991s
	iters: 300, epoch: 5 | loss: 0.3224697
	speed: 0.0508s/iter; left time: 117.0664s
	iters: 400, epoch: 5 | loss: 0.3278059
	speed: 0.0506s/iter; left time: 111.6809s
Epoch: 5 cost time: 22.000200271606445
Epoch: 5, Steps: 434 | Train Loss: 0.3283 Vali Loss: 0.093255
Validation loss decreased (0.100709 --> 0.093255).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3178119
	speed: 0.1563s/iter; left time: 323.6163s
	iters: 200, epoch: 6 | loss: 0.2943603
	speed: 0.0518s/iter; left time: 102.0096s
	iters: 300, epoch: 6 | loss: 0.3087485
	speed: 0.0509s/iter; left time: 95.2647s
	iters: 400, epoch: 6 | loss: 0.3247541
	speed: 0.0506s/iter; left time: 89.6121s
Epoch: 6 cost time: 22.235335111618042
Epoch: 6, Steps: 434 | Train Loss: 0.319 Vali Loss: 0.088475
Validation loss decreased (0.093255 --> 0.088475).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2869040
	speed: 0.1549s/iter; left time: 253.6334s
	iters: 200, epoch: 7 | loss: 0.3316979
	speed: 0.0505s/iter; left time: 77.6543s
	iters: 300, epoch: 7 | loss: 0.3087341
	speed: 0.0510s/iter; left time: 73.3099s
	iters: 400, epoch: 7 | loss: 0.3180144
	speed: 0.0507s/iter; left time: 67.7870s
Epoch: 7 cost time: 22.05767273902893
Epoch: 7, Steps: 434 | Train Loss: 0.31473 Vali Loss: 0.087262
Validation loss decreased (0.088475 --> 0.087262).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3048396
	speed: 0.1554s/iter; left time: 186.9395s
	iters: 200, epoch: 8 | loss: 0.3103421
	speed: 0.0506s/iter; left time: 55.8519s
	iters: 300, epoch: 8 | loss: 0.2943155
	speed: 0.0504s/iter; left time: 50.5424s
	iters: 400, epoch: 8 | loss: 0.3065136
	speed: 0.0503s/iter; left time: 45.4468s
Epoch: 8 cost time: 21.981959104537964
Epoch: 8, Steps: 434 | Train Loss: 0.31255 Vali Loss: 0.086593
Validation loss decreased (0.087262 --> 0.086593).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3208347
	speed: 0.1560s/iter; left time: 119.9307s
	iters: 200, epoch: 9 | loss: 0.2927255
	speed: 0.0507s/iter; left time: 33.9487s
	iters: 300, epoch: 9 | loss: 0.3054538
	speed: 0.0507s/iter; left time: 28.8344s
	iters: 400, epoch: 9 | loss: 0.2790226
	speed: 0.0507s/iter; left time: 23.8016s
Epoch: 9 cost time: 22.05507731437683
Epoch: 9, Steps: 434 | Train Loss: 0.3112 Vali Loss: 0.086526
Validation loss decreased (0.086593 --> 0.086526).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3038842
	speed: 0.1547s/iter; left time: 51.8284s
	iters: 200, epoch: 10 | loss: 0.3366605
	speed: 0.0504s/iter; left time: 11.8370s
	iters: 300, epoch: 10 | loss: 0.3189476
	speed: 0.0509s/iter; left time: 6.8703s
	iters: 400, epoch: 10 | loss: 0.3088087
	speed: 0.0507s/iter; left time: 1.7760s
Epoch: 10 cost time: 21.98502826690674
Epoch: 10, Steps: 434 | Train Loss: 0.30994 Vali Loss: 0.08682
EarlyStopping counter: 1 out of 3
Loading model from ./results/traffic_CALF/2/checkpoint.pth
Updating learning rate to 1.953125e-06
Training ended at 2024-12-01 23:46:53.127095, time taken 0:05:00.143511, per epoch 0:00:30.014351
Loading model from ./results/traffic_CALF/2/checkpoint.pth
val 1732
Preds and Trues shape: (1732, 24, 1) (1732, 24, 1)
flag:val, mse:0.086111, mae:0.20805, rmse: 0.29345.
>>>>>>> testing : <<<<<<<<<<<
test 1731
Preds and Trues shape: (1731, 24, 1) (1731, 24, 1)
flag:test, mse:0.23093, mae:0.3063, rmse: 0.48055.


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/traffic_CALF/3
>>>>>>> training : >>>>>>>>>
train 13916
val 1732
Training started at 2024-12-01 23:47:04.189452.
Loss function weights: 1.0 1.0 0.01
	iters: 100, epoch: 1 | loss: 1.3944334
	speed: 0.0505s/iter; left time: 214.2138s
	iters: 200, epoch: 1 | loss: 1.0041211
	speed: 0.0508s/iter; left time: 210.4231s
	iters: 300, epoch: 1 | loss: 0.7328776
	speed: 0.0508s/iter; left time: 205.0935s
	iters: 400, epoch: 1 | loss: 0.5898768
	speed: 0.0507s/iter; left time: 199.8094s
Epoch: 1 cost time: 22.018957138061523
Epoch: 1, Steps: 434 | Train Loss: 1.0587 Vali Loss: 0.2346
Validation loss decreased (inf --> 0.234599).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4814630
	speed: 0.1598s/iter; left time: 608.4077s
	iters: 200, epoch: 2 | loss: 0.5279118
	speed: 0.0508s/iter; left time: 188.3728s
	iters: 300, epoch: 2 | loss: 0.4745541
	speed: 0.0509s/iter; left time: 183.6830s
	iters: 400, epoch: 2 | loss: 0.4830416
	speed: 0.0506s/iter; left time: 177.4793s
Epoch: 2 cost time: 22.04805016517639
Epoch: 2, Steps: 434 | Train Loss: 0.50206 Vali Loss: 0.17357
Validation loss decreased (0.234599 --> 0.173571).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4351410
	speed: 0.1541s/iter; left time: 519.8622s
	iters: 200, epoch: 3 | loss: 0.3596736
	speed: 0.0509s/iter; left time: 166.5826s
	iters: 300, epoch: 3 | loss: 0.4298202
	speed: 0.0509s/iter; left time: 161.4203s
	iters: 400, epoch: 3 | loss: 0.4177316
	speed: 0.0511s/iter; left time: 157.0765s
Epoch: 3 cost time: 22.068491458892822
Epoch: 3, Steps: 434 | Train Loss: 0.40868 Vali Loss: 0.1383
Validation loss decreased (0.173571 --> 0.138298).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3661058
	speed: 0.1550s/iter; left time: 455.4296s
	iters: 200, epoch: 4 | loss: 0.3604506
	speed: 0.0506s/iter; left time: 143.7128s
	iters: 300, epoch: 4 | loss: 0.3687761
	speed: 0.0508s/iter; left time: 139.1197s
	iters: 400, epoch: 4 | loss: 0.3662065
	speed: 0.0507s/iter; left time: 133.8113s
Epoch: 4 cost time: 22.041114568710327
Epoch: 4, Steps: 434 | Train Loss: 0.37099 Vali Loss: 0.12315
Validation loss decreased (0.138298 --> 0.123151).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3712552
	speed: 0.1558s/iter; left time: 390.1985s
	iters: 200, epoch: 5 | loss: 0.3249468
	speed: 0.0508s/iter; left time: 122.2034s
	iters: 300, epoch: 5 | loss: 0.3543690
	speed: 0.0508s/iter; left time: 117.1632s
	iters: 400, epoch: 5 | loss: 0.3321826
	speed: 0.0508s/iter; left time: 111.9671s
Epoch: 5 cost time: 22.064918756484985
Epoch: 5, Steps: 434 | Train Loss: 0.35412 Vali Loss: 0.1167
Validation loss decreased (0.123151 --> 0.116698).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3402258
	speed: 0.1553s/iter; left time: 321.5290s
	iters: 200, epoch: 6 | loss: 0.3460227
	speed: 0.0504s/iter; left time: 99.3687s
	iters: 300, epoch: 6 | loss: 0.3297828
	speed: 0.0505s/iter; left time: 94.5454s
	iters: 400, epoch: 6 | loss: 0.3516094
	speed: 0.0507s/iter; left time: 89.7846s
Epoch: 6 cost time: 21.9728741645813
Epoch: 6, Steps: 434 | Train Loss: 0.34436 Vali Loss: 0.11745
EarlyStopping counter: 1 out of 3
Loading model from ./results/traffic_CALF/3/checkpoint.pth
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3401034
	speed: 0.0842s/iter; left time: 137.7780s
	iters: 200, epoch: 7 | loss: 0.3746900
	speed: 0.0511s/iter; left time: 78.4893s
	iters: 300, epoch: 7 | loss: 0.3265059
	speed: 0.0507s/iter; left time: 72.8545s
	iters: 400, epoch: 7 | loss: 0.3467706
	speed: 0.0508s/iter; left time: 67.9386s
Epoch: 7 cost time: 22.06546664237976
Epoch: 7, Steps: 434 | Train Loss: 0.34326 Vali Loss: 0.11815
EarlyStopping counter: 2 out of 3
Loading model from ./results/traffic_CALF/3/checkpoint.pth
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3212802
	speed: 0.0847s/iter; left time: 101.8861s
	iters: 200, epoch: 8 | loss: 0.3422251
	speed: 0.0510s/iter; left time: 56.2829s
	iters: 300, epoch: 8 | loss: 0.3250127
	speed: 0.0509s/iter; left time: 51.0848s
	iters: 400, epoch: 8 | loss: 0.3438348
	speed: 0.0509s/iter; left time: 45.9419s
Epoch: 8 cost time: 22.071327447891235
Epoch: 8, Steps: 434 | Train Loss: 0.34379 Vali Loss: 0.11661
Validation loss decreased (0.116698 --> 0.116610).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3403794
	speed: 0.1561s/iter; left time: 120.0141s
	iters: 200, epoch: 9 | loss: 0.3234413
	speed: 0.0504s/iter; left time: 33.7352s
	iters: 300, epoch: 9 | loss: 0.3390978
	speed: 0.0502s/iter; left time: 28.5605s
	iters: 400, epoch: 9 | loss: 0.3513542
	speed: 0.0505s/iter; left time: 23.6649s
Epoch: 9 cost time: 21.913955211639404
Epoch: 9, Steps: 434 | Train Loss: 0.34141 Vali Loss: 0.11586
Validation loss decreased (0.116610 --> 0.115863).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3216528
	speed: 0.1564s/iter; left time: 52.4097s
	iters: 200, epoch: 10 | loss: 0.3345494
	speed: 0.0510s/iter; left time: 11.9738s
	iters: 300, epoch: 10 | loss: 0.3391645
	speed: 0.0508s/iter; left time: 6.8577s
	iters: 400, epoch: 10 | loss: 0.3282651
	speed: 0.0508s/iter; left time: 1.7789s
Epoch: 10 cost time: 22.104540824890137
Epoch: 10, Steps: 434 | Train Loss: 0.34007 Vali Loss: 0.11526
Validation loss decreased (0.115863 --> 0.115262).  Saving model ...
Updating learning rate to 1.953125e-06
Training ended at 2024-12-01 23:51:57.837527, time taken 0:04:53.648075, per epoch 0:00:29.364808
Loading model from ./results/traffic_CALF/3/checkpoint.pth
val 1732
Preds and Trues shape: (1732, 24, 1) (1732, 24, 1)
flag:val, mse:0.11452, mae:0.25024, rmse: 0.33841.
>>>>>>> testing : <<<<<<<<<<<
test 1731
Preds and Trues shape: (1731, 24, 1) (1731, 24, 1)
flag:test, mse:0.269, mae:0.35067, rmse: 0.51865.

