Args in experiment:
Namespace(task_name='classification', train=True, dry_run=False, model='CALF', seed=2024, itrs=3, itr_no=None, data='mimic', result_path='./results', root_path='./dataset/mimic_iii/', data_path='mimic_iii.pkl', flag='test', features='MS', target='OT', freq='h', seq_len=48, label_len=48, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=31, d_model=768, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, model_id='ori', task_loss='ce', feature_loss='l1', distill_loss='l1', logits_loss='l1', output_loss='l1', tmax=20, r=8, lora_alpha=32, lora_dropout=0.1, word_embedding_path='./utils/wte_pca_500.pt', task_w=1.0, feature_w=0.01, logits_w=1.0, output_w=1.0, gpt_layers=6, log_fine_name='CALF_result.txt', noise_scale=-100, bootstrap_eval=0, output_dict=True, use_gpu=True, enc_in=31, dec_in=31, c_out=31)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
model_id  ori
Experiments will be saved in ./results/mimic_iii_CALF/1
>>>>>>> training : >>>>>>>>>
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
val 2299
	iters: 100, epoch: 1 | loss: 1.6783986
	speed: 0.1291s/iter; left time: 729.5037s
	iters: 200, epoch: 1 | loss: 1.2916944
	speed: 0.1249s/iter; left time: 693.5885s
	iters: 300, epoch: 1 | loss: 1.0012609
	speed: 0.1257s/iter; left time: 685.4147s
	iters: 400, epoch: 1 | loss: 0.5171525
	speed: 0.1265s/iter; left time: 676.8928s
	iters: 500, epoch: 1 | loss: 0.6533586
	speed: 0.1272s/iter; left time: 667.7606s
Epoch: 1 cost time: 72.93
Epoch: 1, Steps: 575 |                     Train Loss: 1.3211 Vali Loss: 0.35232
Validation loss decreased (inf --> 0.352320).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6784102
	speed: 0.3384s/iter; left time: 1717.9155s
	iters: 200, epoch: 2 | loss: 0.3869641
	speed: 0.1285s/iter; left time: 639.3580s
	iters: 300, epoch: 2 | loss: 0.5867499
	speed: 0.1293s/iter; left time: 630.5311s
	iters: 400, epoch: 2 | loss: 0.3645913
	speed: 0.1297s/iter; left time: 619.2740s
	iters: 500, epoch: 2 | loss: 0.5001631
	speed: 0.1298s/iter; left time: 606.9920s
Epoch: 2 cost time: 74.26
Epoch: 2, Steps: 575 |                     Train Loss: 0.54544 Vali Loss: 0.43293
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.4373040
	speed: 0.2658s/iter; left time: 1196.1646s
	iters: 200, epoch: 3 | loss: 0.5954612
	speed: 0.1301s/iter; left time: 572.3757s
	iters: 300, epoch: 3 | loss: 0.4730528
	speed: 0.1301s/iter; left time: 559.4211s
	iters: 400, epoch: 3 | loss: 0.2532443
	speed: 0.1301s/iter; left time: 546.5953s
	iters: 500, epoch: 3 | loss: 0.6104095
	speed: 0.1301s/iter; left time: 533.6761s
Epoch: 3 cost time: 74.72
Epoch: 3, Steps: 575 |                     Train Loss: 0.4702 Vali Loss: 0.29495
Validation loss decreased (0.352320 --> 0.294954).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3246641
	speed: 0.3439s/iter; left time: 1350.0003s
	iters: 200, epoch: 4 | loss: 0.3619046
	speed: 0.1296s/iter; left time: 495.9058s
	iters: 300, epoch: 4 | loss: 0.6134467
	speed: 0.1297s/iter; left time: 483.3971s
	iters: 400, epoch: 4 | loss: 0.4639768
	speed: 0.1299s/iter; left time: 471.0671s
	iters: 500, epoch: 4 | loss: 0.3923247
	speed: 0.1300s/iter; left time: 458.3105s
Epoch: 4 cost time: 74.61
Epoch: 4, Steps: 575 |                     Train Loss: 0.41117 Vali Loss: 0.3114
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3622136
	speed: 0.2659s/iter; left time: 891.0943s
	iters: 200, epoch: 5 | loss: 0.5683753
	speed: 0.1301s/iter; left time: 422.9058s
	iters: 300, epoch: 5 | loss: 0.4130672
	speed: 0.1301s/iter; left time: 409.9993s
	iters: 400, epoch: 5 | loss: 0.6331205
	speed: 0.1302s/iter; left time: 397.1162s
	iters: 500, epoch: 5 | loss: 0.6394090
	speed: 0.1301s/iter; left time: 383.9728s
Epoch: 5 cost time: 74.74
Epoch: 5, Steps: 575 |                     Train Loss: 0.41752 Vali Loss: 0.289
Validation loss decreased (0.294954 --> 0.289001).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3696373
	speed: 0.3456s/iter; left time: 959.3165s
	iters: 200, epoch: 6 | loss: 0.3182284
	speed: 0.1296s/iter; left time: 346.7961s
	iters: 300, epoch: 6 | loss: 0.3833598
	speed: 0.1298s/iter; left time: 334.2492s
	iters: 400, epoch: 6 | loss: 0.3349864
	speed: 0.1298s/iter; left time: 321.4460s
	iters: 500, epoch: 6 | loss: 0.3772398
	speed: 0.1299s/iter; left time: 308.5990s
Epoch: 6 cost time: 74.56
Epoch: 6, Steps: 575 |                     Train Loss: 0.36369 Vali Loss: 0.29405
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.2972014
	speed: 0.2658s/iter; left time: 585.0127s
	iters: 200, epoch: 7 | loss: 0.4670464
	speed: 0.1300s/iter; left time: 273.1933s
	iters: 300, epoch: 7 | loss: 0.3683059
	speed: 0.1300s/iter; left time: 260.1179s
	iters: 400, epoch: 7 | loss: 0.5175677
	speed: 0.1300s/iter; left time: 247.1897s
	iters: 500, epoch: 7 | loss: 0.3033806
	speed: 0.1301s/iter; left time: 234.3473s
Epoch: 7 cost time: 74.70
Epoch: 7, Steps: 575 |                     Train Loss: 0.33792 Vali Loss: 0.28828
Validation loss decreased (0.289001 --> 0.288281).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4164783
	speed: 0.3367s/iter; left time: 547.4690s
	iters: 200, epoch: 8 | loss: 0.3383630
	speed: 0.1296s/iter; left time: 197.7848s
	iters: 300, epoch: 8 | loss: 0.2535572
	speed: 0.1298s/iter; left time: 185.0416s
	iters: 400, epoch: 8 | loss: 0.4380274
	speed: 0.1299s/iter; left time: 172.2188s
	iters: 500, epoch: 8 | loss: 0.5304322
	speed: 0.1299s/iter; left time: 159.3133s
Epoch: 8 cost time: 74.60
Epoch: 8, Steps: 575 |                     Train Loss: 0.3288 Vali Loss: 0.28696
Validation loss decreased (0.288281 --> 0.286958).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3170853
	speed: 0.3454s/iter; left time: 363.0065s
	iters: 200, epoch: 9 | loss: 0.1711777
	speed: 0.1295s/iter; left time: 123.1938s
	iters: 300, epoch: 9 | loss: 0.5992758
	speed: 0.1297s/iter; left time: 110.4000s
	iters: 400, epoch: 9 | loss: 0.1022492
	speed: 0.1299s/iter; left time: 97.5185s
	iters: 500, epoch: 9 | loss: 0.2838081
	speed: 0.1299s/iter; left time: 84.5801s
Epoch: 9 cost time: 74.52
Epoch: 9, Steps: 575 |                     Train Loss: 0.32464 Vali Loss: 0.29294
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.4241862
	speed: 0.2658s/iter; left time: 126.5371s
	iters: 200, epoch: 10 | loss: 0.4472056
	speed: 0.1300s/iter; left time: 48.8947s
	iters: 300, epoch: 10 | loss: 0.5578077
	speed: 0.1300s/iter; left time: 35.8928s
	iters: 400, epoch: 10 | loss: 0.2198835
	speed: 0.1300s/iter; left time: 22.8876s
	iters: 500, epoch: 10 | loss: 0.5606053
	speed: 0.1300s/iter; left time: 9.8829s
Epoch: 10 cost time: 74.70
Epoch: 10, Steps: 575 |                     Train Loss: 0.31841 Vali Loss: 0.28649
Validation loss decreased (0.286958 --> 0.286488).  Saving model ...
Loading model from ./results/mimic_iii_CALF/1/checkpoint.pth
Dead patients 229, percentage 9.96.
val 2299
acc 0.90039, f1 0.01717, auc 0.76959
>>>>>>> testing : <<<<<<<<<<<
Dead patients 229, percentage 9.96.
test 2299
acc 0.90257, f1 0.04274, auc 0.75354


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
model_id  ori
Experiments will be saved in ./results/mimic_iii_CALF/2
>>>>>>> training : >>>>>>>>>
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
val 2299
	iters: 100, epoch: 1 | loss: 2.7966952
	speed: 0.1287s/iter; left time: 727.0502s
	iters: 200, epoch: 1 | loss: 0.5427732
	speed: 0.1294s/iter; left time: 718.0541s
	iters: 300, epoch: 1 | loss: 1.0474517
	speed: 0.1297s/iter; left time: 706.9938s
	iters: 400, epoch: 1 | loss: 0.7799930
	speed: 0.1299s/iter; left time: 695.0362s
	iters: 500, epoch: 1 | loss: 0.5723272
	speed: 0.1300s/iter; left time: 682.5945s
Epoch: 1 cost time: 74.51
Epoch: 1, Steps: 575 |                     Train Loss: 1.6581 Vali Loss: 0.31078
Validation loss decreased (inf --> 0.310781).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6627403
	speed: 0.3403s/iter; left time: 1727.2607s
	iters: 200, epoch: 2 | loss: 0.2946395
	speed: 0.1296s/iter; left time: 644.9377s
	iters: 300, epoch: 2 | loss: 0.8433311
	speed: 0.1297s/iter; left time: 632.6594s
	iters: 400, epoch: 2 | loss: 0.6797772
	speed: 0.1299s/iter; left time: 620.3296s
	iters: 500, epoch: 2 | loss: 0.5390265
	speed: 0.1300s/iter; left time: 607.9305s
Epoch: 2 cost time: 74.59
Epoch: 2, Steps: 575 |                     Train Loss: 0.52193 Vali Loss: 0.30086
Validation loss decreased (0.310781 --> 0.300861).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6945974
	speed: 0.3400s/iter; left time: 1530.4333s
	iters: 200, epoch: 3 | loss: 0.4119402
	speed: 0.1298s/iter; left time: 571.4058s
	iters: 300, epoch: 3 | loss: 0.3854957
	speed: 0.1302s/iter; left time: 559.8788s
	iters: 400, epoch: 3 | loss: 0.6766558
	speed: 0.1299s/iter; left time: 545.8779s
	iters: 500, epoch: 3 | loss: 0.2466911
	speed: 0.1300s/iter; left time: 533.1564s
Epoch: 3 cost time: 74.68
Epoch: 3, Steps: 575 |                     Train Loss: 0.46851 Vali Loss: 0.27895
Validation loss decreased (0.300861 --> 0.278949).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4055640
	speed: 0.3383s/iter; left time: 1328.1485s
	iters: 200, epoch: 4 | loss: 0.2835770
	speed: 0.1296s/iter; left time: 495.8756s
	iters: 300, epoch: 4 | loss: 0.5149192
	speed: 0.1298s/iter; left time: 483.7385s
	iters: 400, epoch: 4 | loss: 0.3705356
	speed: 0.1300s/iter; left time: 471.3304s
	iters: 500, epoch: 4 | loss: 0.5367137
	speed: 0.1300s/iter; left time: 458.3932s
Epoch: 4 cost time: 74.62
Epoch: 4, Steps: 575 |                     Train Loss: 0.46396 Vali Loss: 0.39703
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3789181
	speed: 0.2659s/iter; left time: 891.1761s
	iters: 200, epoch: 5 | loss: 0.2575189
	speed: 0.1301s/iter; left time: 422.8663s
	iters: 300, epoch: 5 | loss: 0.4022636
	speed: 0.1301s/iter; left time: 409.9357s
	iters: 400, epoch: 5 | loss: 0.4149063
	speed: 0.1301s/iter; left time: 396.8960s
	iters: 500, epoch: 5 | loss: 0.4960616
	speed: 0.1301s/iter; left time: 383.8823s
Epoch: 5 cost time: 74.72
Epoch: 5, Steps: 575 |                     Train Loss: 0.38372 Vali Loss: 0.28885
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2054908
	speed: 0.2659s/iter; left time: 738.2328s
	iters: 200, epoch: 6 | loss: 0.3895755
	speed: 0.1301s/iter; left time: 348.0781s
	iters: 300, epoch: 6 | loss: 0.1860719
	speed: 0.1300s/iter; left time: 334.9360s
	iters: 400, epoch: 6 | loss: 0.2899201
	speed: 0.1301s/iter; left time: 322.0051s
	iters: 500, epoch: 6 | loss: 0.4197712
	speed: 0.1300s/iter; left time: 308.9560s
Epoch: 6 cost time: 74.70
Epoch: 6, Steps: 575 |                     Train Loss: 0.34854 Vali Loss: 0.28808
EarlyStopping counter: 3 out of 3
Early stopping
Loading model from ./results/mimic_iii_CALF/2/checkpoint.pth
Dead patients 229, percentage 9.96.
val 2299
acc 0.90692, f1 0.17054, auc 0.74938
>>>>>>> testing : <<<<<<<<<<<
Dead patients 229, percentage 9.96.
test 2299
acc 0.90866, f1 0.22222, auc 0.76480


>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
model_id  ori
Experiments will be saved in ./results/mimic_iii_CALF/3
>>>>>>> training : >>>>>>>>>
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
val 2299
	iters: 100, epoch: 1 | loss: 2.2669239
	speed: 0.1295s/iter; left time: 732.0780s
	iters: 200, epoch: 1 | loss: 0.7260253
	speed: 0.1299s/iter; left time: 720.8487s
	iters: 300, epoch: 1 | loss: 0.7011980
	speed: 0.1299s/iter; left time: 708.0786s
	iters: 400, epoch: 1 | loss: 0.7968922
	speed: 0.1299s/iter; left time: 695.2881s
	iters: 500, epoch: 1 | loss: 0.5792826
	speed: 0.1300s/iter; left time: 682.7441s
Epoch: 1 cost time: 74.68
Epoch: 1, Steps: 575 |                     Train Loss: 1.5006 Vali Loss: 0.34146
Validation loss decreased (inf --> 0.341463).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8222936
	speed: 0.3407s/iter; left time: 1729.5395s
	iters: 200, epoch: 2 | loss: 0.5437083
	speed: 0.1295s/iter; left time: 644.5796s
	iters: 300, epoch: 2 | loss: 0.3816494
	speed: 0.1297s/iter; left time: 632.6088s
	iters: 400, epoch: 2 | loss: 0.6000514
	speed: 0.1299s/iter; left time: 620.1932s
	iters: 500, epoch: 2 | loss: 0.4395764
	speed: 0.1299s/iter; left time: 607.3700s
Epoch: 2 cost time: 74.56
Epoch: 2, Steps: 575 |                     Train Loss: 0.50996 Vali Loss: 0.38377
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.9998676
	speed: 0.2658s/iter; left time: 1196.5770s
	iters: 200, epoch: 3 | loss: 0.4684537
	speed: 0.1301s/iter; left time: 572.4503s
	iters: 300, epoch: 3 | loss: 0.4770928
	speed: 0.1301s/iter; left time: 559.5321s
	iters: 400, epoch: 3 | loss: 0.5622930
	speed: 0.1301s/iter; left time: 546.6172s
	iters: 500, epoch: 3 | loss: 0.5660658
	speed: 0.1301s/iter; left time: 533.5473s
Epoch: 3 cost time: 74.73
Epoch: 3, Steps: 575 |                     Train Loss: 0.45146 Vali Loss: 0.30748
Validation loss decreased (0.341463 --> 0.307478).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3955886
	speed: 0.3432s/iter; left time: 1347.2341s
	iters: 200, epoch: 4 | loss: 0.5782628
	speed: 0.1296s/iter; left time: 495.8064s
	iters: 300, epoch: 4 | loss: 0.6762453
	speed: 0.1298s/iter; left time: 483.6772s
	iters: 400, epoch: 4 | loss: 0.5118483
	speed: 0.1299s/iter; left time: 471.0177s
	iters: 500, epoch: 4 | loss: 0.5120101
	speed: 0.1300s/iter; left time: 458.2840s
Epoch: 4 cost time: 74.60
Epoch: 4, Steps: 575 |                     Train Loss: 0.43484 Vali Loss: 0.2749
Validation loss decreased (0.307478 --> 0.274899).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4552492
	speed: 0.3419s/iter; left time: 1145.7762s
	iters: 200, epoch: 5 | loss: 0.2822973
	speed: 0.1295s/iter; left time: 421.1476s
	iters: 300, epoch: 5 | loss: 0.3524663
	speed: 0.1297s/iter; left time: 408.8274s
	iters: 400, epoch: 5 | loss: 0.7140743
	speed: 0.1299s/iter; left time: 396.2253s
	iters: 500, epoch: 5 | loss: 0.3086056
	speed: 0.1300s/iter; left time: 383.5330s
Epoch: 5 cost time: 74.58
Epoch: 5, Steps: 575 |                     Train Loss: 0.41212 Vali Loss: 0.32874
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4582339
	speed: 0.2659s/iter; left time: 738.0776s
	iters: 200, epoch: 6 | loss: 0.3384084
	speed: 0.1300s/iter; left time: 348.0067s
	iters: 300, epoch: 6 | loss: 0.3315224
	speed: 0.1301s/iter; left time: 335.0099s
	iters: 400, epoch: 6 | loss: 0.1465136
	speed: 0.1301s/iter; left time: 322.0763s
	iters: 500, epoch: 6 | loss: 0.4732674
	speed: 0.1301s/iter; left time: 309.0200s
Epoch: 6 cost time: 74.71
Epoch: 6, Steps: 575 |                     Train Loss: 0.42517 Vali Loss: 0.27224
Validation loss decreased (0.274899 --> 0.272242).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4719299
	speed: 0.3431s/iter; left time: 755.1791s
	iters: 200, epoch: 7 | loss: 0.4724843
	speed: 0.1296s/iter; left time: 272.2374s
	iters: 300, epoch: 7 | loss: 0.4229513
	speed: 0.1298s/iter; left time: 259.6349s
	iters: 400, epoch: 7 | loss: 0.4187624
	speed: 0.1299s/iter; left time: 246.8753s
	iters: 500, epoch: 7 | loss: 0.3493392
	speed: 0.1300s/iter; left time: 234.0680s
Epoch: 7 cost time: 74.57
Epoch: 7, Steps: 575 |                     Train Loss: 0.41599 Vali Loss: 0.27409
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.3356189
	speed: 0.2658s/iter; left time: 432.2403s
	iters: 200, epoch: 8 | loss: 0.4466751
	speed: 0.1301s/iter; left time: 198.4873s
	iters: 300, epoch: 8 | loss: 0.1827571
	speed: 0.1301s/iter; left time: 185.5449s
	iters: 400, epoch: 8 | loss: 0.3789537
	speed: 0.1301s/iter; left time: 172.5259s
	iters: 500, epoch: 8 | loss: 0.1115638
	speed: 0.1302s/iter; left time: 159.5697s
Epoch: 8 cost time: 74.74
Epoch: 8, Steps: 575 |                     Train Loss: 0.40589 Vali Loss: 0.27763
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 0.2931025
	speed: 0.2661s/iter; left time: 279.6434s
	iters: 200, epoch: 9 | loss: 0.2477112
	speed: 0.1300s/iter; left time: 123.6693s
	iters: 300, epoch: 9 | loss: 0.5874599
	speed: 0.1301s/iter; left time: 110.6873s
	iters: 400, epoch: 9 | loss: 0.4991272
	speed: 0.1300s/iter; left time: 97.6399s
	iters: 500, epoch: 9 | loss: 0.6147979
	speed: 0.1300s/iter; left time: 84.6289s
Epoch: 9 cost time: 74.70
Epoch: 9, Steps: 575 |                     Train Loss: 0.42103 Vali Loss: 0.2864
EarlyStopping counter: 3 out of 3
Early stopping
Loading model from ./results/mimic_iii_CALF/3/checkpoint.pth
Dead patients 229, percentage 9.96.
val 2299
acc 0.90387, f1 0.15970, auc 0.79112
>>>>>>> testing : <<<<<<<<<<<
Dead patients 229, percentage 9.96.
test 2299
acc 0.90692, f1 0.19549, auc 0.77758

